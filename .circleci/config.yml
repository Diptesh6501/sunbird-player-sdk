version: 2.1
jobs:
  build:
    working_directory: ~/sunbird-player-sdk
    docker:
      - image: circleci/node:12.0.0
    steps:
      - checkout:
          path: ~/sunbird-player-sdk

      - run: sudo npm install
      - run: npm install

      - run:
          name: running test cases
          command: npm run test

      - run: 
          name: Install sonar scanner
          command: 'sudo npm install -g sonarqube-scanner'
          
      - run: 
          name: Sonar scanner
          command: sonar-scanner -Dsonar.projectKey=project-sunbird_sunbird-player-sdk -Dsonar.organization=project-sunbird -Dsonar.sources=. -Dsonar.host.url=https://sonarcloud.io -Dsonar.language=ts -Dsonar.sources=projects/sunbird-player-sdk/src -Dsonar.typescript.lcov.reportPaths=coverage/sunbird-player-sdk/lcov.info
             
workflows:
  version: 2.1
  build_and_test:
    jobs:
      - build
